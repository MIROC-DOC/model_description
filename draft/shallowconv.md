# 浅い積雲のパラメタリゼーション

浅い積雲は熱帯や亜熱帯で対流雲の中では最も頻度が多く，大気放射によるエネルギー収支を介して気候に与える影響が重要視されている。浅い積雲は境界層の大気を自由大気へ輸送する役割を担っており，降水を伴わないことが多く，深い対流のように降水性の下降流が地表まで到達しないことが特徴である．

浅い積雲対流が発生する境界層の鉛直構造について簡単に説明する．地表面が太陽光によって温められた，または上方から冷たい空気が流れ込んだとき，大気の最下層では対流不安定のエネルギーが乱流によって散逸し，海面からおよそ600mから800mの厚さで温度や水がほぼ鉛直一様に分布する混合層を形成する．混合層の上端には弱い安定成層の遷移層があり，ここに対流不安定による上昇流が凝結を始める高度(LCL: lifting condensation level)が位置する．これより上では温度は湿潤断熱減率に従って変化し，上昇流は雲として観察される．さらに上昇して上向きの浮力を受けるようになる高度(LFC: level of free convection)より上まで達する雲は周囲の空気と混合しながら成長を続ける．この対流雲の成長は自由大気下端の温度逆転層で制限され，地表から2km程度に雲頂を持つことが多い．

[Fig. 境界層の温度，湿度プロファイル]

浅い積雲のパラメタリゼーションは気候の再現性や将来予測へ及ぼす影響の評価のためMIROC5から導入された．当該のパッケージpshcn.FはPSHCNとDISTANCEのサブルーチンから成る．PSHCNの主な入力変数は気温，水蒸気量，雲水量，雲氷量である．浅い積雲対流の鉛直輸送に応じた液水温位，総水量，雲氷量，水平風速を予報し，さらに雲量および降水量を診断する．DISTANCEはPSHCN内部で実行され，浅い対流の浮力上昇および環境場との混合の程度を計算するものである．様々な物理過程の中で，浅い積雲が発生する条件の判定には深い対流のパラメタリゼーション(CUMULUS)で診断された変数の値を参照するためPSHCNおよびDISTANCEはCUMULUSの後に雲量の診断を経て実行される．また，降水を陸面や海洋のモデルで参照するため，地表面過程(SURFCE)よりもあとで実行する必要がある．

##  1 <a name='para'></a>雲モデルの基本

格子内の雲は主にBretherton et al. (2004)やPark and Bretherton (2009)で考案された枠組みを元にモデル化する．このスキームではシンプルな雲のプルームモデルを採用し上昇流による保存量の鉛直輸送および降水を計算する．一つの水平格子内の浅い積雲の集団を単一の上昇流プルームで表現し，これが周囲の環境と水平方向の混合(エントレインメント・デトレインメント)を起こすものとする．この上昇流の鉛直フラックスを以下の形で仮定する．

$$\rho \overline {w' \psi '}\approx M_u (\psi_u-\overline{\psi})  $$

ただし$M_u$は上昇流のマスフラックス，$\psi_u$は積雲対流で運ばれる何らかの保存量の上昇流内の代表値，$\overline{\psi}$は同じ保存量の環境場での代表値を表す．質量と保存量それぞれのフラックスの診断式は
$$\frac{\partial M_u}{\partial z} = E - D$$
$$\frac{\partial}{\partial z} (\psi_u M_u) = X_\psi + S_\psi M_u$$
のように書ける．ただし$X_\psi$は環境場との水平方向の混合，$S_\psi$はソース項，$E$および$D$はエントレインメント割合で，
$$E=\varepsilon M_u$$
$$D=\delta M_u$$
として質量フラックスに対する比の形で記述する．$\overline{\psi}$ を格子平均値で代表させ，水平混合の項を$X_{\psi}=E \overline{\psi} - D\psi_u$でパラメタライズすることで，上記のフラックス診断式は
$$\frac{\partial M_u}{\partial z} = M_u (\varepsilon - \delta)$$
$$\frac{\partial \psi_u}{\partial z} = \varepsilon(\overline{\psi} - \psi_u) + S_{\psi}$$
となり$\varepsilon$と$\delta$の二つのパラメーターについてのクロージャー問題に帰着する．これを雲底のでの境界条件とともに解くことで$M_u$と$\psi_u$の鉛直プロファイルを求める．

##  2 <a name='PSHCN'></a>PSHCNでの計算
計算手順の概略は以下の通り．
- 温度$T$，水蒸気量$q_v$，雲水量$q_l$，雲氷量$q_i$から液水温位$\theta_l$と総水量$q_t$を診断する
- 雲底における上昇流のマスフラックス$M_u$を診断する
- 雲底高度を診断する
- 浅い積雲の有無を診断する
- 上昇流内での$M_u$，$\theta_l$，$q_t$、水平風速$u$、$v$の代表値を診断する
- 水の相を診断する($q_v$，$q_l$，$q_i$，$q_r$)
- $\theta_l$、$q_t$、$u$、$v$、$q_i$のフラックスを診断する
- $\theta_l$、$q_t$、$u$、$v$、$q_i$，液水温度$T_l$を予報する
- $T_l$と$q_t$から$T$、$q_v$、$q_l$を診断する
- 雲量$C$と雲水量を補正し、降水量$P$を診断する
- 総水量PDFを変更し，変更したPDFにより雲量などを診断する

### in proc. 2.1 下部境界条件：雲底での質量フラックスの診断
まず雲底における質量フラックス$M_{ubase}$を次のように診断する
<!--
$$M_{ubase} = \overline{\rho_{base}}\int^{\infty}_{w_c}wf(w)dw = \overline{\rho_{base}}\sqrt{\frac{k_f e_{avg}}{2\pi}}\exp\left[ -\frac{w_c^2}{2k_fe_{avg}}\right]$$
-->
次に雲底高度を診断する．

### in proc. 2.2 浅い積雲の発生判定
- 推定逆転層強度(Estimated Inversion Strength, EIS) 
- 深い積雲が卓越する環境場では浅い積雲は発生させない
- 浅い積雲に伴う上昇流の面積が或る閾値を越えない場合浅い積雲の計算を省略する。 

### 2.3 エントレインメントとデトレインメントの判定
サブルーチンDISTANCEでは，質量フラックスのクロージャーを計算する過程での上昇する雲パーセルと環境場との混合の程度を計算する．上昇流の液水温位(THETLU)とエントレインメント・デトレインメントの判定(JUDGE)が出力変数である．

エントレインメントの条件は以下のように判定される．まず上昇流が飽和しているかを判断し，飽和していなければエントレインメントは起こらない．
次にパーセルに働く浮力を
$$B_u = g\frac{\theta_{vu} - \overline{\theta_{v}}}{ \overline{\theta_v}}$$
で計算し，正の浮力を持つ場合にはエントレインメントが起こるとする．
さらに，浮力が負の場合でも慣性によってある渦混合距離$l_c$を超えて上昇し続けることができる場合にはエントレインメントが起こるものとする．混合距離は$l_c \equiv c_1 H$で定義する．ただし$H$は対流層の厚さで，定数$c_1=0.1$は貿易風帯のケースに最適化した値を使用している．
上昇流内の浮力$B_u$が臨界値
$$B_c = -\frac{1}{2}\frac{w_u^2}{l_c}$$
を超えていればエントレインメントが起こると判定される．
ここで求めた$l_c$だけ上昇できるような最初の混合状態の臨界値$\chi_c$を求めることで，エントレインメントによって上昇流内に取り込まれる環境場の空気の総量が計算できる．

[Fig. chi-theta_B04] 

### in proc. 2.4 上昇流内部の予報

###  in proc. 2.5 雲量と雨水量の補正

##  in proc.  3 <a name='-1'></a>実装に際しての補足

###  in proc. <a name='-1'></a>雲量診断サブルーチンの実行順

###  in proc. <a name='-1'></a>質量フラックスのリミッター