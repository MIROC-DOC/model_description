\hypertarget{features-and-structure-of-the-model}{%
\subsection{Features and structure of the
model}\label{features-and-structure-of-the-model}}

\textbf{NOTE: the descriptions in this section are outdated.}

\hypertarget{basic-features-of-the-model.}{%
\subsubsection{Basic Features of the
Model.}\label{basic-features-of-the-model.}}

The MIROC6 AGCM is a numerical model for describing the global
three-dimensional atmosphere based on physical laws and calculating the
time evolution of the system as an initial value problem or a boundary
value problem.

The data to be inputted are as follows.

\begin{itemize}
\item
  Initial data for each prognostic variable (horizontal wind speed,
  temperature, surface pressure, specific humidity, cloud liquid water
  content, etc.)
\item
  Boundary condition data (surface elevation, surface condition, sea
  surface temperature, etc.)
\item
  Various parameters of the model (atmospheric components, physical
  process parameters, etc.)
\end{itemize}

On the other hand, the output is the following.

\begin{itemize}
\item
  Data for each prognostic parameter and diagnostic parameter, for each
  time or time average
\item
  Initial data to be used for continuous execution (restart data)
\item
  Progress and various diagnostic messages
\end{itemize}

The prognostic variable is the data obtained as a time series by
integrating the differential equation of time evolution, and the
diagnostic variable is the quantity calculated from the prognostic
variable, the boundary conditions and the parameters by some method that
does not include time integration.

More specifically, the model basically solves the following equations
(prognostic equations).

\begin{eqnarray}
  \frac{\partial{u}}{\partial {t}}  =  \left( {\mathcal F}_x \right)_D + \left( {\mathcal F}_x \right)_P.
   \\
  \frac{\partial{v}}{\partial {t}}  =  \left( {\mathcal F}_y \right)_D + \left( {\mathcal F}_y \right)_P. \\
  \frac{\partial{T}}{\partial {t}}  =  \left( Q \right)_D + \left( Q \right)_P. \\
  \frac{\partial{p_S}}{\partial {t}}  =  \left( M \right)_D + \left( M \right)_P. \\
  \frac{\partial{q}}{\partial {t}}  =  \left( S \right)_D + \left( S \right)_P. \\
  \frac{\partial{T_g}}{\partial {t}}  =  \left( Q_g \right)_D + \left( Q_g \right)_P.
\end{eqnarray}

Here, \(u,v,T,p_S,q,T_g\) are two-dimensional and three-dimensional
prognostic variables such as eastward wind, northward wind, temperature,
surface pressure, specific humidity, and surface state amount,
respectively, and the right-hand side is a term that causes time
variation of each prognostic variable. The terms
\({\mathcal F}_x,{\mathcal F}_y,Q,S,Q_g\) are calculated based on the
prognostic variables \(u,v,T,p_S,q,T_g\), are divided into two main
categories: the terms \(u\) and \(v\), such as advection due to the
motion of the atmosphere (the terms with index \(D\) in the above
equation), and the terms such as cloud and radiation (the terms with
index \(P\) in the above equation). There are two main types of terms.
The former is called the dynamical process, and the latter is called the
physical process.

The advection term is the main part of the time-varying term in
dynamical processes, and the accurate estimation of the spatial
derivative is important in its calculation. The MIROC6 AGCM utilizes the
spherical harmonic expansion to calculate the horizontal differential
term. On the other hand, it is important for physical processes to be
represented in a simple model with parameters (parameterization), such
as energy conversions due to the phase change of water, radiative
absorption and emission, the effects of small-scale atmospheric motions,
and the effects of various processes on the ground surface.

The time integration of the prognostic equation is done by approximating
the left-hand side of (1) etc. by the difference. For example,

\begin{eqnarray}
  \frac{\partial{q}}{\partial {t}} \rightarrow \frac{q^{t+\Delta t} - q^{t}}{\Delta t}
\end{eqnarray}

By making ,

\begin{eqnarray}
  q^{t+\Delta t} = q^{t}
       + \Delta t \left[ \left( S \right)_D + \left( S \right)_P  \right]
\end{eqnarray}

where \(S\) is a function of the prognostic variables \(u,v,T,p_S,q\).
Although \(S\) is a function of the prognostic variables
\(u,v,T,p_S,q\), and so on, there are various time difference schemes
that can be used in this calculation depending on the time of day the
prognostic variables are used to evaluate \(S\). The MIROC6 AGCM uses
the Euler method, which uses the value of the \(t\) as it is, the leap
frog method, which uses the value of the \(t+\Delta t/2\), and the
implicit method, which uses the (approximate) value of the
\(t+\Delta t\).

In the MIROC6 AGCM, the time integration of the prognostic variables is
done separately for the dynamical and physical processes. The dynamical
processes basically use a leap frog,

\begin{eqnarray}
  \tilde{q}^{t+\Delta t} = q^{t-\Delta t} + 2 \Delta t \left( S \right)_D^{t}
\end{eqnarray}

However, some terms are treated as implicit. In the physical process,
based on the results of integrating the dynamical terms, the Euler and
implicit methods are used together,

\begin{eqnarray}
  q^{t+\Delta t} = \tilde{q}^{t+\Delta t} + 2 \Delta t \left( S \right)_P
\end{eqnarray}

in (8). Note that \(\Delta t\) in (8) is replaced by \(2 \Delta t\).

\hypertarget{model-execution-flow.}{%
\subsubsection{Model Execution Flow.}\label{model-execution-flow.}}

The flow of the model execution is briefly shown below. The entries in
the index are the names of the corresponding subroutine.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  set the parameters of an experiment, coordinates, etc.
\end{enumerate}

\texttt{SUBROUTINE:{[}PCONST,ASETCO,SETPAR,SETTSTRT,SETTEND{]}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\item
  read the initial values of the prognostic variables
  \texttt{SUBROUTINE:{[}RDSTRT{]}}
\item
  start the time step \texttt{SUBROUTINE:{[}TIMSTP{]}}
\item
  perform time integration by mechanical processes
  \texttt{SUBROUTINE:{[}DYNMCS{]}}
\item
  perform time integration by physical processes
  \texttt{SUBROUTINE:{[}PHYSCS{]}}
\item
  advance the time \texttt{MODULE:{[}TFILT{]}}
\item
  Output the data if necessary \texttt{MODULE:{[}HISTOU{]}}
\item
  Output the restart data if necessary \texttt{SUBROUTINE:{[}WRRSTR{]}}
\item
  Return to 3
\end{enumerate}

\hypertarget{prognostic-variables}{%
\subsubsection{Prognostic variables}\label{prognostic-variables}}

The prognostic variables are as follows. The values in parentheses are
the coordinate system, and \(\lambda,\varphi,\sigma, z\) indicate the
longitude, latitude, dimensionless pressure, \(\sigma\), and vertical
depth, respectively. The values in the square brackets are in units of
the index.

\setlength\LTleft{0pt}\setlength\LTright{0pt}\begin{longtable}[]{@{}lll@{}}
\toprule\relax
\begin{minipage}[b]{0.30\columnwidth}\raggedright
Element\strut
\end{minipage} & \begin{minipage}[b]{0.30\columnwidth}\raggedright
Symbol\strut
\end{minipage} & \begin{minipage}[b]{0.30\columnwidth}\raggedright
Unit\strut
\end{minipage}\tabularnewline
\midrule\relax
\endhead
\begin{minipage}[t]{0.30\columnwidth}\raggedright
eastward wind speed\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(u\) (\(\lambda,\varphi,\sigma\))\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(\mathrm{[m/s]}\)\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.30\columnwidth}\raggedright
northward wind speed\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(v\) (\(\lambda,\varphi,\sigma\))\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(\mathrm{[m/s]}\)\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.30\columnwidth}\raggedright
atmospheric temperature\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(T\) (\(\lambda,\varphi,\sigma\))\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(\mathrm{[K]}\)\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.30\columnwidth}\raggedright
surface pressure\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(p_S\) (\(\lambda,\varphi\))\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(\mathrm{[hPa]}\)\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.30\columnwidth}\raggedright
specific humidity\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(q\) (\(\lambda,\varphi,\sigma\))\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(\mathrm{[kg/kg]}\)\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.30\columnwidth}\raggedright
cloud water specific humidity\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(l\) (\(\lambda,\varphi,\sigma\))\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(\mathrm{[kg/kg]}\)\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.30\columnwidth}\raggedright
cloud ice specific humidity\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(q_i\) (\(\lambda,\varphi,\sigma\))\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(\mathrm{[kg/kg]}\)\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.30\columnwidth}\raggedright
total water PDF variance\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(V\) (\(\lambda,\varphi,\sigma\))\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(\mathrm{ND}\)\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.30\columnwidth}\raggedright
total water PDF skewness\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(S\) (\(\lambda,\varphi,\sigma\))\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(\mathrm{ND}\)\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.30\columnwidth}\raggedright
variance of liquid potential temperature\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(TSQ\) (\(\lambda,\varphi,\sigma\))\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(\mathrm{K^2}\)\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.30\columnwidth}\raggedright
covariance of liquid potential temperature and total water\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(COV\) (\(\lambda,\varphi,\sigma\))\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(\mathrm{K}\)\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.30\columnwidth}\raggedright
variance of total water\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(QSQ\) (\(\lambda,\varphi,\sigma\))\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\(\mathrm{ND}\)\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.30\columnwidth}\raggedright
tracers\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\strut
\end{minipage} & \begin{minipage}[t]{0.30\columnwidth}\raggedright
\strut
\end{minipage}\tabularnewline
\bottomrule
\end{longtable}

Of these quantities, the quantities for turbulence process,
\(TSQ, COV, QSQ\), store only one step at a time, while the quantities
for the atmosphere, \(u, v, T, p_S, q, l, q_i, V, S\), need to store two
steps at a time. This is due to the fact that the leap frog method is
used in the time integration of the dynamic process of the quantities
related to the atmosphere.

The quantities of the atmosphere, \(u, v, T, p_S, q, l\), are variables
managed by the main routine,
\texttt{Administration\ of\ the\ Atmosphere\textquotesingle{}{[}AGCM5\textbackslash{}a{]}}.
On the other hand, the quantities relating to the earth's surface and
ground, \(q_i, V, S, TSQ, COV, QSQ\), do not appear in the main routine,
but are managed by the subroutine \texttt{MODULE:{[}PHYSCS{]}} of the
physical process.

Tracers include mass concentrations of aerosol species,

\hypertarget{the-flow-of-time-evolution-of-variables}{%
\subsubsection{The flow of time evolution of
variables}\label{the-flow-of-time-evolution-of-variables}}

This subsection is to be written.
