\hypertarget{horizontal-discretization}{%
\subsection{Horizontal discretization}\label{horizontal-discretization}}

The horizontal discretization is based on the spectral transformation
method (Bourke, 1988). The differential terms for longitude and latitude
are evaluated by the orthogonal function expansion, while the non-linear
terms are calculated on the grid.

\hypertarget{spectral-expansion.}{%
\subsubsection{Spectral Expansion.}\label{spectral-expansion.}}

As an expansion function, the spherical harmonic functions
\(Y_n^m(\lambda,\mu)\), which are eigenfunction of Laplacian on a
sphere, are used. However, \(\mu \equiv \sin\varphi\) is used. \(Y_n^m\)
satisfies the following equation,

\begin{eqnarray}
\nabla^{2}_{\sigma} Y_n^m(\lambda,\mu)
= - \frac{n(n+1)}{a^{2}} Y_n^m(\lambda,\mu)
\end{eqnarray}

Using the Legendre jury function \(P_n^m\) it is written as follows.

\begin{eqnarray}
Y_n^m(\lambda,\mu) = P_n^m (\mu) e^{\mathrm{i}m \lambda}
\end{eqnarray}

However, it is \(n \geq | m |\).

The expansion by spherical harmonic functions is ,

\begin{eqnarray}
   {Y_n^m}_{ij} \equiv Y_n^m ( \lambda_i, \mu_j )
\end{eqnarray}

When I write ,

\begin{eqnarray}
  X_{ij} \equiv X ( \lambda_i, \mu_j )
   =  \mathcal{Re} \sum_{m=-N}^{N} \sum_{n=|m|}^{N}
        X_n^m {Y_n^m}_{ij} ,
\end{eqnarray}

The inverse of that is ,

\begin{eqnarray}
  X_n^m
         =  \frac{1}{4 \pi}
             \int_{-1}^{1} d \mu \int_{0}^{\pi} d \lambda
               X( \lambda, \mu ) Y_n^{m *} ( \lambda, \mu ) \\
         =  \frac{1}{I} \sum_{i=1}^{I} \sum_{j=1}^{J}  
               X_{ij} {Y_n^{m*}}_{ij} w_j
\end{eqnarray}

The formula is expressed as To evaluate by replacing the integral with a
sum, we use the Gauss trapezoidal formula for the \(\lambda\) integral
and the Gauss-Legendre integral formula for the \(\mu\) integral.
\(\mu_j\) is the Gauss latitude and \(w_j\) is the Gauss load. Also,
\(\lambda_i\) is a grid of evenly spaced Gauss loads.

Using spectral expansion, the grid point values of the terms containing
the derivatives can be calculated as follows.

\begin{eqnarray}
        \left(  \frac{\partial X}{\partial \lambda} \right)_{ij}
     =  
        {\mathcal Re} \sum_{m=-N}^{N} \sum_{n=|m|}^{N}
       \mathrm{i}m X_n^m {Y_n^m}_{ij}
\end{eqnarray}

\begin{eqnarray}
   \left( \cos\varphi \frac{\partial X}{\partial \varphi} \right)_{ij}
     =  {\mathcal Re} \sum_{m=-N}^{N} \sum_{n=|m|}^{N}
       X_n^m
       ( 1-\mu^{2} ) \frac{\partial }{\partial \mu} {Y_n^m}_{ij}
\end{eqnarray}

Furthermore, the grid point values of \(u,v\) can be obtained from the
spectral components of \(\zeta\) and \(D\) as follows

\begin{eqnarray}
  u_{ij}
  = \frac{1}{\cos\varphi}
     {\mathcal Re} \sum_{m=-N}^{N}
                       \sum_{\stackrel{n=|m|}{n \neq 0}}^{N}
    \left\{
             \frac{a}{n(n+1)} \zeta_n^m
            (1-\mu^{2}) \frac{\partial{}}{\partial {\mu}} {Y_n^m}_{ij}
          -  \frac{\mathrm{i}m a}{n(n+1)} D_n^m {Y_n^m}_{ij}
    \right\}
\end{eqnarray}

\begin{eqnarray}
  v_{ij}
  = \frac{1}{\cos\varphi}
   {\mathcal Re} \sum_{m=-N}^{N}
                     \sum_{\stackrel{n=|m|}{n \neq 0}}^{N}
    \left\{
          -  \frac{\mathrm{i}m a}{n(n+1)} \zeta_n^m {Y_n^m}_{ij}
          -  \frac{a}{n(n+1)} D_n^m
            (1-\mu^{2}) \frac{\partial{}}{\partial {\mu}} {Y_n^m}_{ij}
    \right\}
\end{eqnarray}

The derivative appearing in the advection term of the equation is
calculated as

\begin{eqnarray}
  \left( \frac{1}{a\cos\varphi} \frac{\partial{A}}{\partial {\lambda}} \right)_n^m
   =  \frac{1}{4 \pi}
        \int_{-1}^{1} d \mu \int_{0}^{\pi} d \lambda
          \frac{1}{a\cos\varphi} \frac{\partial{A}}{\partial {\lambda}} Y_n^{m *} \\
   =  \frac{1}{4 \pi}
        \int_{-1}^{1} d \mu \int_{0}^{\pi} d \lambda \,
          \mathrm{i}m A \cos\varphi \frac{1}{a(1-\mu^{2})} Y_n^{m *} \\
   =  \frac{1}{I} \sum_{i=1}^{I} \sum_{j=1}^{J}  
          \mathrm{i}m A_{ij} \cos\varphi_j
          {Y_n^{m *}}_{ij} \frac{w_j}{a(1-\mu_j^{2})}
\end{eqnarray}

\begin{eqnarray}
  \left( \frac{1}{a\cos\varphi}
         \frac{\partial{}}{\partial {\varphi}} (A\cos\varphi) \right)_n^m
    =  \frac{1}{4 \pi a}
         \int_{-1}^{1} d \mu \int_{0}^{\pi} d \lambda
           \frac{\partial{}}{\partial {\mu}} (A\cos\varphi) Y_n^{m *}  \\
    =  - \frac{1}{4 \pi a}
         \int_{-1}^{1} d \mu \int_{0}^{\pi} d \lambda
           A \cos\varphi \frac{\partial }{\partial \mu} Y_n^{m *}
            \\
   =  - \frac{1}{I} \sum_{i=1}^{I} \sum_{j=1}^{J}  
          A_{ij}  \cos\varphi_j
          (1-\mu_j^2)  \frac{\partial }{\partial \mu}
          {Y_n^{m *}}_{ij} \frac{w_j}{a(1-\mu_j^{2})}
\end{eqnarray}

Furthermore,

\begin{eqnarray}
     \left( \nabla^{2}_{\sigma} X \right)_n^m
       =  - \frac{n(n+1)}{a^{2}} X_n^m
\end{eqnarray}

to be used for the evaluation of the \(\nabla^2\) section.

\hypertarget{horizontal-diffusion-term}{%
\subsubsection{Horizontal Diffusion
Term}\label{horizontal-diffusion-term}}

The horizontal diffusion term is entered in the form \(\nabla^{N_D}\) as
follows.

\begin{eqnarray}
  {\mathcal D}(\zeta) = K_{MH}
                      \left[ (-1)^{N_D/2} \nabla^{N_D}
                              - \left( \frac{2}{a^2} \right)^{N_D/2}
                      \right]
                    \zeta ,
\end{eqnarray}

\begin{eqnarray}
     {\mathcal D}(D) = K_{MH}
                      \left[ (-1)^{N_D/2} \nabla^{N_D}
                              - \left( \frac{2}{a^2} \right)^{N_D/2}
                      \right]
                    D ,
\end{eqnarray}

\begin{eqnarray}
    {\mathcal D}(T) = (-1)^{N_D/2} K_{HH} \nabla^{N_D} T ,
\end{eqnarray}

\begin{eqnarray}
    {\mathcal D}(q) = (-1)^{N_D/2} K_{EH} \nabla^{N_D} q .
\end{eqnarray}

This horizontal diffusion term has strong implications for computational
stability. In order to represent selective horizontal diffusion on small
scales, 4 \(\sim\) 16 is used as \(N_D\). Here, the extra term for
vorticity and divergence diffusion indicates that the term of rigid body
rotation in \(n=1\) does not decay.

\hypertarget{spectral-representation-of-equations}{%
\subsubsection{Spectral representation of
equations}\label{spectral-representation-of-equations}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  a series of equations
\end{enumerate}

\begin{eqnarray}
  \frac{\partial{\pi_m^m}}{\partial {t}}
  =  - \sum_{k=1}^{K} (D_n^m)_k \Delta  \sigma_k  \\
     + \frac{1}{I} \sum_{i=1}^{I} \sum_{j=1}^{J}  
               Z_{ij} {Y_n^{m *}}_{ij} w_j  ,
\end{eqnarray}

Here,

\begin{eqnarray}
Z \equiv - \sum_{k=1}^{K} \mathbf{v}_k \cdot \nabla \pi .
\end{eqnarray}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  equation of motion
\end{enumerate}

\begin{eqnarray}
  \frac{\partial{\zeta_n^m}}{\partial {t}}
    =  \frac{1}{I} \sum_{i=1}^{I} \sum_{j=1}^{J}  
          \mathrm{i}m (A_v)_{ij} \cos\varphi_j
          {Y_n^{m *}}_{ij}
         \frac{w_j}{a(1-\mu_j^{2})}
         \\
    +    \frac{1}{I} \sum_{i=1}^{I} \sum_{j=1}^{J}  
          (A_u)_{ij} \cos\varphi_j
          (1-\mu_j^2)
          \frac{\partial }{\partial \mu} {Y_n^{m *}}_{ij}
          \frac{w_j}{a(1-\mu_j^{2})}
          \\
    -   ({\mathcal D}_M)_n^m \zeta_n^m  \; ,
\end{eqnarray}

\begin{eqnarray}
  \frac{\partial{\tilde{D}_n^m}}{\partial {t}}
   =  \frac{1}{I} \sum_{i=1}^{I} \sum_{j=1}^{J}  
          \mathrm{i}m (A_u)_{ij} \cos\varphi_j
          {Y_n^{m *}}_{ij}
         \frac{w_j}{a(1-\mu_j^{2})}
          \\
    -    \frac{1}{I} \sum_{i=1}^{I} \sum_{j=1}^{J}  
          (A_v)_{ij} \cos\varphi_j
          (1-\mu_j^2)
          \frac{\partial }{\partial \mu} {Y_n^{m *}}_{ij}
          \frac{w_j}{a(1-\mu_j^{2})}
          \\
    -   \frac{n(n+1)}{a^{2}}
         \frac{1}{I} \sum_{i=1}^{I} \sum_{j=1}^{J}  
          E_{ij} {Y_n^{m *}}_{ij} w_j
          \\
    +   \frac{n(n+1)}{a^{2}}
          ( \Phi_n^m + C_{p} \hat{\kappa}_k \bar{T}_k \pi_n^m )
          -  ({\mathcal D}_M)_n^m D_n^m  ,
\end{eqnarray}

However,

\begin{eqnarray}
({\mathcal D}_M)_n^m = K_{MH} \left[
                            \left( \frac{n(n+1)}{a^{2}} \right)^{N_D/2}
                            - \left( \frac{2}{a^2} \right)^{N_D/2}
                            \right]  .
\end{eqnarray}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  thermodynamic equation
\end{enumerate}

\begin{eqnarray}
  \frac{\partial{T_n^m}}{\partial {t}}
   =  - \frac{1}{I} \sum_{i=1}^{I} \sum_{j=1}^{J}  
          \mathrm{i}m u_{ij} T'_{ij} \cos\varphi_j
          {Y_n^{m *}}_{ij}
         \frac{w_j}{a(1-\mu_j^{2})}
          \\
     + \frac{1}{I} \sum_{i=1}^{I} \sum_{j=1}^{J}  
          v_{ij} T'_{ij} \cos\varphi_j
          (1-\mu_j^2)
          \frac{\partial }{\partial \mu} {Y_n^{m *}}_{ij}
          \frac{w_j}{a(1-\mu_j^{2})}
          \\
     + \frac{1}{I} \sum_{i=1}^{I} \sum_{j=1}^{J}  
          \left( H_{ij} + \frac{Q_{ij}+Q_{diff}}{C_{p}} \right)
          {Y_n^{m *}}_{ij} w_j
          \\
     - (\tilde{\mathcal D}_H)_n^m T_n^m \; ,
\end{eqnarray}

However,

\begin{eqnarray}
({\mathcal D}_H)_n^m
   =  K_{HH} \left( \frac{n(n+1)}{a^{2}} \right)^{N_D/2} .
\end{eqnarray}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{3}
\tightlist
\item
  water vapor formula
\end{enumerate}

\begin{eqnarray}
  \frac{\partial{q_n^m}}{\partial {t}}
   =  - \frac{1}{I} \sum_{i=1}^{I} \sum_{j=1}^{J}  
          \mathrm{i}m u_{ij} q_{ij} \cos\varphi_j
          {Y_n^{m *}}_{ij} \frac{w_j}{a(1-\mu_j^{2})}
          \\
     + \frac{1}{I} \sum_{i=1}^{I} \sum_{j=1}^{J}  
          v_{ij} q_{ij} \cos\varphi_j
          (1-\mu_j^2)
          \frac{\partial }{\partial \mu} {Y_n^{m *}}_{ij}
          \frac{w_j}{a(1-\mu_j^{2})}
          \\
     + \frac{1}{I} \sum_{i=1}^{I} \sum_{j=1}^{J}  
          \left( \hat{R}_{ij} + S_{q,ij} \right)
          {Y_n^{m *}}_{ij} w_j
          \\
     + ({\mathcal D}_H)_n^m q_n^m
\end{eqnarray}

However,

\begin{eqnarray}
({\mathcal D}_E)_n^m
   =  K_{EH} \left( \frac{n(n+1)}{a^{2}} \right)^{N_D/2} .
\end{eqnarray}
