## 水平離散化

水平方向の離散化は スペクトル変換法を用いる(Bourke, 1988). 経度, 緯度に関する微分の項は直交関数展開によって評価し, 一方, 非線型項は格子点上で計算する.

### スペクトル展開

展開関数系としては球面上の Laplacianの固有関数系である 球面調和関数 TERM00229,TERM00229 を用いる. ただし, TERM00230 である. TERM00231 は次のような方程式を満たし,

    EQ=00039.

Legendre 陪関数 TERM00232 を用いて次のように書き表される.

    EQ=00040.

ただし, TERM00233 である.

球面調和関数による展開は ,

    EQ=00041.

と書くと,

    EQ=00042.

その逆変換は,

    EQ=00056.
    EQ=00056.

のように表される. 積分を和に置き換えて評価する際には, TERM00236 積分については Gauss の台形公式を, TERM00237 積分については Gauss-Legendre 積分公式を用いる. TERM00238 は Gauss 緯度, TERM00239 は Gauss 荷重である. また, TERM00240 は等間隔の格子である.

スペクトル展開を用いれば, 微分を含む項の格子点値は次のように求められる.

    EQ=00043.

    EQ=00044.

さらに, TERM00243, TERM00244 のスペクトル成分から, TERM00245,TERM00245 の格子点値が以下のように得られる.

    EQ=00045.

    EQ=00046.

方程式の移流項に現れる微分は, 次のように求められる.

    EQ=00057.
    EQ=00057.
    EQ=00057.

    EQ=00058.
    EQ=00058.
    EQ=00058.

さらに,

    EQ=00047.

を TERM00248 の項の評価のために用いる.

### 水平拡散項

水平拡散項は, 次のように TERM00249 の形で入れる.

    EQ=00048.

    EQ=00049.

    EQ=00050.

    EQ=00051.

この水平拡散項は計算の安定化のための意味合いが強い. 小さなスケールに選択的な水平拡散を表すため, TERM00250 としては, 4 TERM00251 16を用いる. ここで, 渦度および発散の拡散についている余分な項は, TERM00252 の剛体回転の項が減衰しないことを表したものである.

### 方程式のスペクトル表現

1.  連続の式
    
        EQ=00059.
        EQ=00059.
    
    ここで,
    
        EQ=00052.

2.  運動方程式
    
        EQ=00060.
        EQ=00060.
        EQ=00060.
    
        EQ=00061.
        EQ=00061.
        EQ=00061.
        EQ=00061.
    
    ただし,
    
        EQ=00053.

3.  熱力学の式
    
        EQ=00062.
        EQ=00062.
        EQ=00062.
        EQ=00062.
    
    ただし,
    
        EQ=00054.

4.  水蒸気の式
    
        EQ=00063.
        EQ=00063.
        EQ=00063.
        EQ=00063.
    
    ただし,
    
        EQ=00055.
