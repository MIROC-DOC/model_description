## 鉛直拡散

### 鉛直拡散スキームの概要

鉛直拡散スキームは,
サブグリッドスケールの乱流拡散による
物理量の鉛直フラックスを評価する.
主な入力データは, 風速, TERM00000,TERM00000, 気温 TERM00001, 比湿 TERM00002, 雲水量 TERM00003, であり,
出力データは, 運動量, 熱, 水蒸気, 雲水の鉛直フラックスと
implicit 解を得るための微分値である.

鉛直拡散係数の見積りには
Mellor and Yamada(1974, 1982)の
乱流クロージャーモデルの
level 2 のパラメタリゼーションを用いる.

計算手順の概略は以下の通りである.

1.  大気の安定度として
    Richardson 数を計算する.

2.  Richardson 数から拡散係数を計算する `MODULE:[VDFCOF]`.

3.  拡散係数からフラックスとその微分を計算する.

### フラックス計算の基本式

大気中の鉛直拡散フラックスは,
拡散係数 TERM00004 を用いて, 以下のように評価される.

    EQ=00000.

    EQ=00001.

    EQ=00002.

    EQ=00003.

### Richardson 数

大気の成層安定度の基準となる,
バルクRichardson数 TERM00005 は

    EQ=00004.

で定義される.
ここで, TERM00006 は TERM00007 を表す.
また, TERM00008 は, 静水圧の式より,

    EQ=00005.

フラックスRicahrdson数 TERM00009 は,

    EQ=00006.

ただし,

    EQ=00020.
    EQ=00020.
    EQ=00020.
    EQ=00020.
    EQ=00020.
    EQ=00020.

    EQ=00007.

    EQ=00008.

TERM00010 と TERM00011 の関係を図示すると,
図[\[p-dif:rib-rif\]](#p-dif:rib-rif) のようになる.

### 拡散係数

拡散係数は,
各層の境界(TERM00012 レベル)ごとに,
次のように与えられる.

    EQ=00021.
    EQ=00021.

ここで, TERM00015,TERM00015 は,

    EQ=00009.

    EQ=00010.

を用いて,

    EQ=00022.
    EQ=00022.

TERM00016 は混合距離であり, Blakadar(1962)に従って,

    EQ=00011.

ととる.
TERM00017 は Kárman 定数である.
現在の標準値は, TERM00018 m である.

TERM00019,TERM00019 を TERM00020 の関数として示すと,
図[\[p-dif:smsh-rif\]](#p-dif:smsh-rif) のようになる.

### フラックスの計算

以上を用い, フラックスおよびフラックス微分を計算する.

    EQ=00012.

    EQ=00013.

    EQ=00014.

    EQ=00015.

    EQ=00016.

    EQ=00017.

    EQ=00018.

    EQ=00019.

### 拡散係数の最小値

非常に安定な場合に, 以上の見積りは拡散係数として 0 を与える.
これをそのまま用いるとモデルの振舞いにさまざまな
悪影響をもたらすので, 適当な最小値を置く.
現在の標準値は, 全てのフラックスに共通で
TERM00022 0.15 TERM00023/s である.

### その他の留意点

浅い積雲対流 `MODULE:[SHLCOF]` を呼んでいるが,
標準ではこれはダミーである.
