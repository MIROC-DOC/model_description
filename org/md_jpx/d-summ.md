## 力学部分のまとめ

ここでは, これまでの記述と重複するが, 力学過程部で行なわれる計算を列挙する.

### 力学部分の計算の概要

力学過程は, 以下のような順序で計算が行なわれる.

1.  水平風の渦度・発散への変換 `MODULE:[UV2VDG(dvect)]`

2.  仮温度の計算 `MODULE:[VIRTMD(dvtmp)]`

3.  気圧傾度項の計算 `MODULE:[HGRAD(dvect)]`

4.  鉛直流の診断的計算 `MODULE:[GRDDYN/PSDOT(dgdyn)]`

5.  移流による時間変化項 `MODULE:[GRDDYN(dgdyn)]`

6.  予報変数のスペクトルへの変換 `MODULE:[GD2WD(dg2wd)]`

7.  時間変化項のスペクトルへの変換 `MODULE:[TENG2W(dg2wd)]`

8.  スペクトル値時間積分 `MODULE:[TINTGR(dintg)]`

9.  予報変数の格子点値への変換 `MODULE:[GENGD(dgeng)]`

10. 疑似等 TERM00356 面拡散補正 `MODULE:[CORDIF(ddifc)]`

11. 拡散による摩擦熱の考慮 `MODULE:[CORFRC(ddifc)]`

12. 質量の保存の補正 `MODULE:[MASFIX(dmfix)]`

13. (物理過程) `MODULE:[PHYSCS(padmn)]`

14. (時間フィルター) `MODULE:[TFILT(aadvn)]`

### 水平風の渦度・発散への変換

水平風の格子点値 TERM00357,TERM00357 から渦度・発散の格子点値 TERM00358,TERM00358 を求める. まず, 渦度・発散のスペクトル TERM00359,TERM00359 を求める,

    EQ=00140.
    EQ=00140.

    EQ=00141.
    EQ=00141.

それをさらに,

    EQ=00107.

等を用いて格子点値に変換する.

### 仮温度の計算

仮温度 TERM00361 は,

    EQ=00142.

ただし, TERM00362 であり, TERM00363 は水蒸気の気体定数 (461 TERM00364TERM00365) TERM00366 は空気の気体定数 (287.04 TERM00367TERM00368) である.

### 気圧傾度項の計算

気圧傾度項 TERM00369 は, まず, TERM00370 を

    EQ=00108.

でスペクトル表現に直してから,

    EQ=00109.

    EQ=00110.

### 鉛直流の診断的計算

気圧変化項, および鉛直流,

    EQ=00111.

    EQ=00112.

ならびにその非重力波成分を計算する.

    EQ=00113.

    EQ=00114.

### 移流による時間変化項

運動量移流項:

    EQ=00143.
    EQ=00143.

    EQ=00144.
    EQ=00144.

    EQ=00115.

温度移流項:

    EQ=00116.

    EQ=00117.

    EQ=00145.
    EQ=00145.
    EQ=00145.
    EQ=00145.
    EQ=00145.
    EQ=00145.

水蒸気移流項:

    EQ=00118.

    EQ=00119.

    EQ=00120.

### 予報変数のスペクトルへの変換

(122) および (123) を用いて

TERM00380,TERM00380 を 渦度・発散のスペクトル表現 TERM00381,TERM00381 に変換する. さらに, 温度 TERM00382, 比湿 TERM00383, TERM00384 を

    EQ=00121.

でスペクトル表現に変換する.

### 時間変化項のスペクトルへの変換

渦度の時間変化項

    EQ=00146.
    EQ=00146.
    EQ=00146.

発散の時間変化項の非重力波成分

    EQ=00147.
    EQ=00147.
    EQ=00147.
    EQ=00147.

温度の時間変化項の非重力波成分

    EQ=00148.
    EQ=00148.
    EQ=00148.

水蒸気の時間変化項

    EQ=00149.
    EQ=00149.
    EQ=00149.

### スペクトル値時間積分

行列形式の方程式

    EQ=00150.
    EQ=00150.
    EQ=00150.
    EQ=00150.

を LU 分解を用いて解くことによって TERM00394 を求め,

    EQ=00122.

    EQ=00123.

によって TERM00400, TERM00401 を求めて, TERM00402 におけるスペクトルの値を計算する.

    EQ=00151.
    EQ=00151.
    EQ=00151.
    EQ=00151.
    EQ=00151.

### 予報変数の格子点値への変換

渦度・発散のスペクトル値 TERM00403,TERM00403 から 水平風速の格子点値 TERM00404,TERM00404 を求める.

    EQ=00124.

    EQ=00125.

さらに,

    EQ=00126.

などによって, TERM00408,TERM00408 を求め,

    EQ=00152.

を計算する.

### 疑似等 TERM00409 面拡散補正

水平拡散は 等 TERM00410 面上で適用されるが, 山岳の傾斜の大きな領域では, 山を上る方向に水蒸気が輸送され, 山頂部での偽の降水をもたらすなどの問題を起こす. それを緩和するために, 等 TERM00411 面の拡散に近くなるような 補正を TERM00412,TERM00412 について入れる.

    EQ=00153.
    EQ=00153.
    EQ=00153.

であるから,

    EQ=00127.

などととする. TERM00413 は, TERM00414 のスペクトル値 TERM00415 に 拡散係数のスペクトル表現をかけたものを 格子の値に変換して用いる.

### 拡散による摩擦熱の考慮

拡散による摩擦熱は,

    EQ=00128.

と見積もられる. したがって,

    EQ=00129.

### 質量の保存の補正

スペクトル法による取扱いは, TERM00416 の全球積分は丸め誤差を除いて保存するが, 質量, すなわち TERM00417 の全球積分の保存は保証されない. また, スペクトルの波数打ちきりにともない, 水蒸気の格子点値に負の値が出ることがある. これらの事情から, 乾燥大気の質量と水蒸気, 雲水の質量を保存させ, さらに負の水蒸気量となる領域を除去するための補正を行なう.

まず, 力学の計算の最初に `MODULE:[FIXMAS]`, 水蒸気, 雲水の各成分の全球積分値 TERM00418,TERM00418 を計算しておく.

    EQ=00154.
    EQ=00154.

また, 計算の最初のステップで 乾燥質量 TERM00419 を計算し, 記憶する.

    EQ=00155.

力学計算の終りには `MODULE:[MASFIX]`, 以下のような手順で補正を行なう.

1.  まず, 負の水蒸気量となる格子点について, 直下の格子点から水蒸気を分配して, 負の水蒸気を除去する. TERM00420 であるとすると,
    
        EQ=00156.
        EQ=00156.
    
    ただし, これは TERM00421 となる場合にのみ行なう.

2.  次に上の手続きで除去されなかった格子点について値を 0 とする.

3.  全球積分値 TERM00422 を計算し, これが TERM00423 と一致するように, 全球の水蒸気量に一定割合をかける.
    
        EQ=00130.

4.  乾燥空気質量の補正を行なう. 同様に TERM00424 を計算し,
    
        EQ=00131.

### 水平拡散とレーリー摩擦

水平拡散の係数をスペクトル表現すると,

    EQ=00132.

    EQ=00133.

    EQ=00134.

TERM00425 は レーリー摩擦係数である. レーリー摩擦係数は

    EQ=00135.

のようなプロファイルで与える. ただし,

    EQ=00136.

と近似する. 標準値は, TERM00426, TERM00427 (TERM00428 : モデルの最上レベル), TERM00429 m, TERM00430 m である.

### 時間フィルター

leap frog における計算モードの除去のために Asselin(1972) の時間フィルターを毎ステップ適用する.

    EQ=00137.

と TERM00431 を求める. 次のステップの力学過程で用いる TERM00432 としては, この TERM00433 を用いる. TERM00434 としては標準的に 0.05 を使用する.

実際には まず, 予報変数の格子点値への変換 `MODULE:[GENGD]` の箇所で,

    EQ=00138.

を求めておき, 物理過程の処理が終わり TERM00435 の値が確定した後で `MODULE:[TFILT]` で,

    EQ=00139.

とする.
