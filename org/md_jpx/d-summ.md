## 力学部分のまとめ

ここでは, これまでの記述と重複するが,
力学過程部で行なわれる計算を列挙する.

### 力学部分の計算の概要

力学過程は, 以下のような順序で計算が行なわれる.

1.  水平風の渦度・発散への変換 `MODULE:[UV2VDG(dvect)]`

2.  仮温度の計算 `MODULE:[VIRTMD(dvtmp)]`

3.  気圧傾度項の計算 `MODULE:[HGRAD(dvect)]`

4.  鉛直流の診断的計算 `MODULE:[GRDDYN/PSDOT(dgdyn)]`

5.  移流による時間変化項 `MODULE:[GRDDYN(dgdyn)]`

6.  予報変数のスペクトルへの変換 `MODULE:[GD2WD(dg2wd)]`

7.  時間変化項のスペクトルへの変換 `MODULE:[TENG2W(dg2wd)]`

8.  スペクトル値時間積分 `MODULE:[TINTGR(dintg)]`

9.  予報変数の格子点値への変換 `MODULE:[GENGD(dgeng)]`

10. 疑似等 TERM00000 面拡散補正 `MODULE:[CORDIF(ddifc)]`

11. 拡散による摩擦熱の考慮 `MODULE:[CORFRC(ddifc)]`

12. 質量の保存の補正 `MODULE:[MASFIX(dmfix)]`

13. (物理過程) `MODULE:[PHYSCS(padmn)]`

14. (時間フィルター) `MODULE:[TFILT(aadvn)]`

### 水平風の渦度・発散への変換

水平風の格子点値 TERM00001,TERM00001
から渦度・発散の格子点値 TERM00002,TERM00002 を求める.
まず, 渦度・発散のスペクトル
TERM00003,TERM00003 を求める,

> EQ=00033.  
> <span id="d-summ:uv-zeta" label="d-summ:uv-zeta">\[d-summ:uv-zeta\]</span>
> EQ=00033.

> EQ=00034.  
> <span id="d-summ:uv-D" label="d-summ:uv-D">\[d-summ:uv-D\]</span>
> EQ=00034.

それをさらに,

> EQ=00000.

等を用いて格子点値に変換する.

### 仮温度の計算

仮温度 TERM00004 は,

> EQ=00035.

ただし, TERM00005 であり,
TERM00006 は水蒸気の気体定数
(461 TERM00007TERM00008)
TERM00009 は空気の気体定数
(287.04 TERM00010TERM00011)
である.

### 気圧傾度項の計算

気圧傾度項 TERM00012 は,
まず, TERM00013 を

> EQ=00001.

でスペクトル表現に直してから,

> EQ=00002.

> EQ=00003.

### 鉛直流の診断的計算

気圧変化項, および鉛直流,

> EQ=00004.

> EQ=00005.

ならびにその非重力波成分を計算する.

> EQ=00006.

> EQ=00007.

### 移流による時間変化項

運動量移流項:

> EQ=00036.  
> EQ=00036.

> EQ=00037.  
> EQ=00037.

> EQ=00008.

温度移流項:

> EQ=00009.

> EQ=00010.

> EQ=00038.  
> EQ=00038.  
> EQ=00038.  
> EQ=00038.  
> EQ=00038.  
> EQ=00038.

水蒸気移流項:

> EQ=00011.

> EQ=00012.

> EQ=00013.

### 予報変数のスペクトルへの変換

([\[d-summ:uv-zeta\]](#d-summ:uv-zeta)) および
([\[d-summ:uv-D\]](#d-summ:uv-D)) を用いて

TERM00014,TERM00014 を
渦度・発散のスペクトル表現
TERM00015,TERM00015 に変換する.
さらに,
温度 TERM00016, 比湿 TERM00017,
TERM00018 を

> EQ=00014.

でスペクトル表現に変換する.

### 時間変化項のスペクトルへの変換

渦度の時間変化項

> EQ=00039.  
> EQ=00039.  
> EQ=00039.

発散の時間変化項の非重力波成分

> EQ=00040.  
> EQ=00040.  
> EQ=00040.  
> EQ=00040.

温度の時間変化項の非重力波成分

> EQ=00041.  
> EQ=00041.  
> EQ=00041.

水蒸気の時間変化項

> EQ=00042.  
> EQ=00042.  
> EQ=00042.

### スペクトル値時間積分

行列形式の方程式

> EQ=00043.  
> EQ=00043.  
> EQ=00043.  
> EQ=00043.

を LU 分解を用いて解くことによって
TERM00019 を求め,

> EQ=00015.

> EQ=00016.

によって
TERM00020,
TERM00021
を求めて, TERM00022 におけるスペクトルの値を計算する.

> EQ=00044.  
> EQ=00044.  
> EQ=00044.  
> EQ=00044.  
> EQ=00044.

### 予報変数の格子点値への変換

渦度・発散のスペクトル値 TERM00023,TERM00023 から
水平風速の格子点値 TERM00024,TERM00024 を求める.

> EQ=00017.

> EQ=00018.

さらに,

> EQ=00019.

などによって, TERM00025,TERM00025 を求め,

> EQ=00045.

を計算する.

### 疑似等 TERM00026 面拡散補正

水平拡散は 等 TERM00027 面上で適用されるが,
山岳の傾斜の大きな領域では, 山を上る方向に水蒸気が輸送され,
山頂部での偽の降水をもたらすなどの問題を起こす.
それを緩和するために, 等 TERM00028 面の拡散に近くなるような
補正を TERM00029,TERM00029 について入れる.

> EQ=00046.  
> EQ=00046.  
> EQ=00046.

であるから,

> EQ=00020.

などととする.
TERM00030 は, TERM00031 のスペクトル値 TERM00032 に
拡散係数のスペクトル表現をかけたものを
格子の値に変換して用いる.

### 拡散による摩擦熱の考慮

拡散による摩擦熱は,

> EQ=00021.

と見積もられる.
したがって,

> EQ=00022.

### 質量の保存の補正

スペクトル法による取扱いは,
TERM00033 の全球積分は丸め誤差を除いて保存するが,
質量, すなわち TERM00034 の全球積分の保存は保証されない.
また, スペクトルの波数打ちきりにともない,
水蒸気の格子点値に負の値が出ることがある.
これらの事情から,
乾燥大気の質量と水蒸気, 雲水の質量を保存させ,
さらに負の水蒸気量となる領域を除去するための補正を行なう.

まず, 力学の計算の最初に `MODULE:[FIXMAS]`,
水蒸気, 雲水の各成分の全球積分値 TERM00035,TERM00035 を計算しておく.

> EQ=00047.  
> EQ=00047.

また, 計算の最初のステップで
乾燥質量 TERM00036 を計算し, 記憶する.

> EQ=00048.

力学計算の終りには `MODULE:[MASFIX]`,
以下のような手順で補正を行なう.

1.  まず, 負の水蒸気量となる格子点について,
    直下の格子点から水蒸気を分配して,
    負の水蒸気を除去する.
    TERM00037 であるとすると,
    
    > EQ=00049.  
    > EQ=00049.
    
    ただし, これは TERM00038 となる場合にのみ行なう.

2.  次に上の手続きで除去されなかった格子点について値を 0 とする.

3.  全球積分値 TERM00039 を計算し,
    これが TERM00040 と一致するように,
    全球の水蒸気量に一定割合をかける.
    
    > EQ=00023.

4.  乾燥空気質量の補正を行なう.
    同様に TERM00041 を計算し,
    
    > EQ=00024.

### 水平拡散とレーリー摩擦

水平拡散の係数をスペクトル表現すると,

> EQ=00025.

> EQ=00026.

> EQ=00027.

TERM00042 は レーリー摩擦係数である.
レーリー摩擦係数は

> EQ=00028.

のようなプロファイルで与える.
ただし,

> EQ=00029.

と近似する.
標準値は, TERM00043,
TERM00044 (TERM00045 : モデルの最上レベル),
TERM00046 m,
TERM00047 m である.

### 時間フィルター

leap frog における計算モードの除去のために
Asselin(1972) の時間フィルターを毎ステップ適用する.

> EQ=00030.

と TERM00048 を求める.
次のステップの力学過程で用いる TERM00049 としては,
この TERM00050 を用いる.
TERM00051 としては標準的に 0.05 を使用する.

実際には
まず, 予報変数の格子点値への変換 `MODULE:[GENGD]` の箇所で,

> EQ=00031.

を求めておき, 物理過程の処理が終わり
TERM00052 の値が確定した後で `MODULE:[TFILT]` で,

> EQ=00032.

とする.
