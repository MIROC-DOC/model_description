## 水平離散化

水平方向の離散化は
スペクトル変換法を用いる(Bourke, 1988).
経度, 緯度に関する微分の項は直交関数展開によって評価し,
一方, 非線型項は格子点上で計算する.

### スペクトル展開

展開関数系としては球面上の Laplacianの固有関数系である
球面調和関数 TERM00000,TERM00000 を用いる.
ただし, TERM00001 である.
TERM00002 は次のような方程式を満たし,

    EQ=00000.

Legendre 陪関数 TERM00003 を用いて次のように書き表される.

    EQ=00001.

ただし, TERM00004 である.

球面調和関数による展開は ,

    EQ=00002.

と書くと,

    EQ=00003.

その逆変換は,

    EQ=00017.
    EQ=00017.

のように表される.
積分を和に置き換えて評価する際には,
TERM00007 積分については Gauss の台形公式を,
TERM00008 積分については Gauss-Legendre 積分公式を用いる.
TERM00009 は Gauss 緯度, TERM00010 は Gauss 荷重である.
また, TERM00011 は等間隔の格子である.

スペクトル展開を用いれば,
微分を含む項の格子点値は次のように求められる.

    EQ=00004.

    EQ=00005.

さらに,
TERM00014, TERM00015 のスペクトル成分から,
TERM00016,TERM00016 の格子点値が以下のように得られる.

    EQ=00006.

    EQ=00007.

方程式の移流項に現れる微分は,
次のように求められる.

    EQ=00018.
    EQ=00018.
    EQ=00018.

    EQ=00019.
    EQ=00019.
    EQ=00019.

さらに,

    EQ=00008.

を TERM00019 の項の評価のために用いる.

### 水平拡散項

水平拡散項は, 次のように TERM00020 の形で入れる.

    EQ=00009.

    EQ=00010.

    EQ=00011.

    EQ=00012.

この水平拡散項は計算の安定化のための意味合いが強い.
小さなスケールに選択的な水平拡散を表すため,
TERM00021 としては, 4 TERM00022 16を用いる.
ここで, 渦度および発散の拡散についている余分な項は,
TERM00023 の剛体回転の項が減衰しないことを表したものである.

### 方程式のスペクトル表現

1.  連続の式
    
        EQ=00020.
        EQ=00020.
    
    ここで,
    
        EQ=00013.

2.  運動方程式
    
        EQ=00021.
        EQ=00021.
        EQ=00021.
    
        EQ=00022.
        EQ=00022.
        EQ=00022.
        EQ=00022.
    
    ただし,
    
        EQ=00014.

3.  熱力学の式
    
        EQ=00023.
        EQ=00023.
        EQ=00023.
        EQ=00023.
    
    ただし,
    
        EQ=00015.

4.  水蒸気の式
    
        EQ=00024.
        EQ=00024.
        EQ=00024.
        EQ=00024.
    
    ただし,
    
        EQ=00016.
