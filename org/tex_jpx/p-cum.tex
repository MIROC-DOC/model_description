
\subsection{積雲対流}

\subsubsection{積雲対流スキームの概要}

積雲対流スキームは,
積雲対流にかかわる凝結・降水・対流過程を表現し,
潜熱の放出とそれにともなう対流運動による
温度とと水蒸気量の変化と降水を計算する.
また, 放射に関与する雲水量と雲の被覆率を計算する.
主な入力データは, 気温 TERM00000, 比湿 TERM00001 であり,
出力データは気温と比湿の時間変化率,
TERM00002,TERM00002,
放射に用いられる積雲の雲水量 TERM00003 雲量 TERM00004 である.

積雲対流スキームの枠組は
基本的に Arakawa and Schubert (1974) に基づく.
1つの水平格子での鉛直気柱を
パラメタリゼーションの基本単位として考える.
雲は雲内の温度,比湿,雲水量と
鉛直上向き質量フラックスで特徴づけられ,
一つの鉛直気柱内で雲頂の違う複数の雲を考慮する.
雲は水平格子の中の一部を占め, 残りの周囲領域には
雲の質量フラックスに等しい下降流(補償下降流)が存在する.
この補償下降流と雲の中の空気の周囲領域への流出(デトレインメント)
によって, 周囲領域の温度・比湿場が変化する.
積雲対流の上昇流域の面積は小さいとし,
格子平均の温度・比湿場と
周囲領域の温度・比湿場を同一視して扱うので,
これによって格子平均の温度・比湿の変化が求まる.

雲内の温度,比湿,雲水量を決めるのは雲モデルである.
ここでは, エントレイン・プリューム型のモデルを用い,
Moorthi and Suarez (1992) と同様に,
高さに関して直線的な質量フラックスの増大を仮定する.
雲底は, 地表大気の持ち上げ凝結高度とし,
周囲領域の空気の取り込み(エントレインメント)の割合の
違いによって複数の雲頂高度の雲を考慮する.
ただし, その雲底を持つ雲が存在し得ないような場合には,
より高い雲底を持つ雲の可能性も考慮する.

各雲の質量フラックスは雲仕事関数を用いて診断的に求める.
雲仕事関数は, 単位質量フラックスあたりの
浮力による仕事の鉛直積分として定義される.
この雲仕事関数が, 積雲の補償下降流等の作用によって
ある緩和時間で0に近付けるような質量フラックスを与える.

さらに, 降水の蒸発と
それにともなうダウンドラフトの効果を
非常に簡単な形で考慮する.

計算手順の概略は以下の通りである.
括弧内は対応するサブルーチン名である.
%
\begin{enumerate}
\item 雲底高度を地表大気の持ち上げ凝結高度として
      評価する.
\item 雲モデルを用いて, 
      各雲頂高度に対応する
      雲の温度,比湿,雲水量,質量フラックス(相対値)の
      鉛直分布を求める \texttt{MODULE:[UPDRF]}.
\item 雲仕事関数を計算する \texttt{MODULE:[CWF]}.
\item 単位質量フラックスの雲による
      周囲領域の温度・比湿の仮想的な変化を求める \texttt{MODULE:[CLDTST]}.
\item 仮想変化した温度・比湿に対する
      雲仕事関数を計算する \texttt{MODULE:[CWF]}.
\item 仮想変化前後の雲仕事関数を用いて
      雲底での雲質量フラックスを計算する \texttt{MODULE:[CBFLX]}.
\item 雲質量フラックス・デトレインメントの
      鉛直分布と降水量を計算する \texttt{MODULE:[CMFLX]}.
\item 積雲による雲水量・雲量を評価する \texttt{MODULE:[CMCLD]}.
\item デトレインメントによる
      温度・比湿の変化を求める \texttt{MODULE:[CLDDET]}.
\item 補償下降流による
      温度・比湿の変化を求める \texttt{MODULE:[CLDSBH]}.
\item 降水の蒸発と
      ダウンドラフトの
      雲の温度,比湿,質量フラックスの
      鉛直分布を求める \texttt{MODULE:[DWNEVP]}.
\item ダウンドラフトのデトレインメントによる
      温度・比湿の変化を求める \texttt{MODULE:[CLDDDE]}.      
\item ダウンドラフトの補償上昇流による
      温度・比湿の変化を求める \texttt{MODULE:[CLDSBH]}.
\end{enumerate}

\subsubsection{Arakawa-Schubertスキームの基本的枠組}

雲の質量フラックス TERM00005, デトレインメント TERM00006 は, 
\begin{verbatim}
EQ=00021.
EQ=00021.
\end{verbatim}
と表される. 
TERM00007 を雲底 TERM00008 での質量フラックスであり,
TERM00009 はそれで無次元化された質量フラックスである.

これにより, 平均場の時間変化は, 以下のように求められる.
\begin{verbatim}
EQ=00022.
EQ=00022.
\end{verbatim}
ただし, TERM00010,TERM00010 は平均場の湿潤静的エネルギーと比湿,
TERM00011,TERM00011 はデトレインメントに含まれる空気の
湿潤静的エネルギー, 比湿, 雲水量である.

TERM00012,TERM00012 は雲モデルによって求められる.
TERM00013 は雲仕事関数を用いたクロージャの仮定によって求める.

\subsubsection{雲モデル}

雲モデルは, 基本的にエントレイン・プリュームモデルである.
各種の雲はエントレインメント率で特徴づけられ,
それに応じてさまざまな雲頂高度を持つことになる.
ただし, 後の計算の都合のため, 
ここではまず雲頂高度を指定し, 
それに対応するエントレインメント率を求めることにより
雲の鉛直構造を求める.
高さに関して直線的な質量フラックスの増大を仮定することにより.
この計算は逐次近似を含まない形に簡単化される.

雲底高度 TERM00014 を, 
地表大気の持ち上げ凝結高度, すなわち,
\begin{verbatim}
EQ=00000.
\end{verbatim}
をみたす最低の TERM00015 として定義する.

無次元化された質量フラックス TERM00016 は, 
エントレインメント率を TERM00017 として,
\begin{verbatim}
EQ=00001.
\end{verbatim}
すなわち,
\begin{verbatim}
EQ=00023.
EQ=00023.
\end{verbatim}

雲の中の湿潤静的エネルギー TERM00018, 総水量 TERM00019 に関する収支は,
\begin{verbatim}
EQ=00024.
EQ=00024.
\end{verbatim}
ここで, TERM00020,TERM00020 はそれぞれ,
平均場の TERM00021 および TERM00022, 降水生成である.

積分すると,
\begin{verbatim}
EQ=00025.
EQ=00025.
\end{verbatim}
\begin{verbatim}
EQ=00026.
EQ=00026.
EQ=00026.
\end{verbatim}

質量フラックスは地表で0であるとし,
雲底より下においても直線的に増大すると仮定する,
\begin{verbatim}
EQ=00002.
\end{verbatim}
この雲底より下のエントレインメントを計算することにより,
雲底での TERM00023,TERM00023 が求められる. すなわち,
\begin{verbatim}
EQ=00027.
EQ=00027.
\end{verbatim}

雲による単位質量フラックスあたりの浮力は,
\begin{verbatim}
EQ=00028.
EQ=00028.
EQ=00028.
EQ=00028.
\end{verbatim}
ここで, TERM00024 は仮温度, TERM00025 は飽和比湿,
TERM00026,
TERM00027 であり,
TERM00028,TERM00028 は, それぞれ平均場の飽和時の値を示す.
また, TERM00029,TERM00029 は雲の水蒸気量, 雲水量であり,
\begin{verbatim}
EQ=00029.
EQ=00029.
\end{verbatim}
雲頂 TERM00030 においては, 浮力 TERM00031 が0であるとする.
従って, TERM00032 を解けば, 与えられた雲頂高度 TERM00033 に対応する
TERM00034 を求めることができる.
ここで, 地表面から上に積分した降水率 TERM00035 に関しては, 
既知の関数 TERM00036 を用いて以下のように
表されると仮定する. 
\begin{verbatim}
EQ=00003.
\end{verbatim}
すると, 
\begin{verbatim}
EQ=00004.
\end{verbatim}

TERM00037 は簡単に解くことができて,
\begin{verbatim}
EQ=00005.
\end{verbatim}
ただし, 
\begin{verbatim}
EQ=00030.
EQ=00030.
\end{verbatim}

前述のように本来は TERM00038 を指定して TERM00039 を求めるのであり,
ある TERM00040 に対して物理的に意味のある TERM00041 が
求まるかどうかの保証はない. 
その吟味が必要であるが, ここでは,
TERM00042 が小さくなるほど TERM00043 が
低くなるべきであることを考慮に入れる.
\begin{verbatim}
EQ=00006.
\end{verbatim}
が満たされるかどうかの吟味を行ない,
満たされない場合は雲頂 TERM00044 を持つ雲は存在しないとして処理を行なう.
また, TERM00045 に最小値を設け, 
これより小さい TERM00046 の雲は存在しないとする.
これは, エントレインメント率がプリュームの大きさに
反比例することから考えると, 
プリュームの大きさに最大があることに相当する.

雲水量 TERM00047 は,
\begin{verbatim}
EQ=00031.
EQ=00031.
\end{verbatim}
ただし, TERM00048 の場合には TERM00049 である.
さらに, 一度降水したものが上昇後雲水になることは考えられないので,
TERM00050 は TERM00051 の増加関数でなければならない.
これにより TERM00052 に制限がつくことになる.

デトレインメントの空気の特性値は,
\begin{verbatim}
EQ=00032.
EQ=00032.
EQ=00032.
\end{verbatim}

TERM00053 の場合は,
雲は存在しないとする. この場合,
\begin{verbatim}
EQ=00007.
\end{verbatim}
を満たす TERM00054 が存在するときには,
その直上を新たに TERM00055 とし,
\begin{verbatim}
EQ=00033.
EQ=00033.
\end{verbatim}
として求める.

\subsubsection{雲仕事関数(CWF)}

雲仕事関数(CWF), TERM00056 は,
\begin{verbatim}
EQ=00008.
\end{verbatim}
であり,
\begin{verbatim}
EQ=00009.
\end{verbatim}
本来は, 後述するダウンドラフトにともなう仕事も
勘定に入れるべきだが, ここでは簡単のために無視する.

この計算の際, 下から出発して
一度正の浮力を持った雲が負の浮力を持つ場合には,
本来負になるところで雲頂が存在するべきであるので,
現在考慮している雲頂を持つ雲は存在しないとして処理を行なう.

\subsubsection{雲底での雲質量フラックス}

雲底での雲質量フラックスは,
ある時間スケール TERM00057 で,
雲の作用によって雲仕事関数が 0 に近付くように決まる
という仮定を置く.

それを見積もるために, まず, 単位雲底質量フラックス TERM00058 の雲による
平均場の時間変化を求める.
\begin{verbatim}
EQ=00034.
EQ=00034.
\end{verbatim}
これにより,
\begin{verbatim}
EQ=00035.
EQ=00035.
\end{verbatim}
を計算し, TERM00059,TERM00059 を用いて
(\ref{p-cum:cwf}) から雲仕事関数を計算したものを TERM00060 とおく.

すると,
\begin{verbatim}
EQ=00010.
\end{verbatim}
となる.
ここで, TERM00061 を求める際に本来は TERM00062,TERM00062 に対応した
雲の鉛直構造を計算しなおすべきであるが, 
現在は同じ雲の構造を用いて行なっている.

\subsubsection{雲の質量フラックス, 降水}

各雲頂高度の雲の総和の, 
雲の質量フラックス TERM00063 は
\begin{verbatim}
EQ=00011.
\end{verbatim}

また, 降水のフラックス TERM00064 は,
\begin{verbatim}
EQ=00012.
\end{verbatim}

\subsubsection{平均場の時間変化}

補償下降流およびデトレインメントによる
平均場の時間変化は, 以下のように求められる.
\begin{verbatim}
EQ=00036.
EQ=00036.
\end{verbatim}
ただし, TERM00065 である.

\subsubsection{降水の蒸発とダウンドラフト}

降水は未飽和の大気中を落下し, その間に一部が蒸発する.
さらにその一部は, ダウンドラフトを形成する.

蒸発率 TERM00066 は,
\begin{verbatim}
EQ=00013.
\end{verbatim}
ただし, TERM00067 は湿球温度に対応する飽和比湿であり,
\begin{verbatim}
EQ=00014.
\end{verbatim}
TERM00068,TERM00068 は微物理のパラメータである.
TERM00069 は降水粒子の密度であり, TERM00070 を降水の終端速度として,
\begin{verbatim}
EQ=00015.
\end{verbatim}
現在の標準値は TERM00071, TERM00072, TERM00073 m/s である.

ダウンドラフトについては, 次の様な仮定を行う.
\begin{itemize}
\item 雲底の上で TERM00074 が高度とともに単調減少する
      領域の上端を TERM00075 とすると, ダウンドラフトは,
      TERM00076 なる領域で起こる.
\item 各高度で起こる降水蒸発の一定割合が
      ダウンドラフトの形成に用いられる.
      降水の蒸発によってちょうど飽和状態となった
      周囲領域の空気が
      ダウンドラフトに取り込まれる(エントレインメント).
\item TERM00077 ではデトレインメントが起き,
      質量フラックスは直線的に減少する.
\end{itemize}

すなわち, TERM00078 において, 質量フラックス TERM00079, 
ダウンドラフトの空気塊の TERM00080,TERM00080 は以下の式に従う.
降水の蒸発時には湿潤静的エネルギーは保存すること,
ならびに蒸発によって飽和になったときの比湿が
TERM00081 であることに注意. 
\begin{verbatim}
EQ=00016.
\end{verbatim}
\begin{verbatim}
EQ=00037.
EQ=00037.
\end{verbatim}

上式で, TERM00082 は蒸発のうちダウンドラフトにとりこまれる分であり,
TERM00083 は平均場に直接蒸発する. 
ただし, ダウンドラフトの質量フラックス TERM00084 は
雲底の質量フラックスの合計 TERM00085 の TERM00086 倍を越えないとする.
現在の標準値は TERM00087,TERM00087 である.

\subsubsection{雲水量と雲量}

放射に用いる格子平均の雲水量 TERM00088 は, 
雲水 TERM00089 を含む積雲の強い上昇域の
占める割合を TERM00090 とすると,
\begin{verbatim}
EQ=00017.
\end{verbatim}
質量フラックス TERM00091 は, この TERM00092 と
上昇流の鉛直速度 TERM00093 を用いて
\begin{verbatim}
EQ=00018.
\end{verbatim}
となるから, 結局,
\begin{verbatim}
EQ=00019.
\end{verbatim}

放射の見積りに用いられる雲量 TERM00094  は, 
実際には上昇流や雲水の分布に水平方向の広がりがあることを
考えると, この TERM00095  よりはかなり大きな値をとるのが妥当である.
ここでは, 簡単に, 
\begin{verbatim}
EQ=00020.
\end{verbatim}
とする.
現在の標準値は, TERM00096, TERM00097 である.
